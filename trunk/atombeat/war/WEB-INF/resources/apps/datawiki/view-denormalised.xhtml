<!--
    Copyright (C) 2010 University of Oxford

    This program is free software; you can redistribute it and/or modify it under the terms of the
    GNU Lesser General Public License as published by the Free Software Foundation; either version
    2.1 of the License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU Lesser General Public License for more details.

    The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
-->
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xforms="http://www.w3.org/2002/xforms"
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      xmlns:ev="http://www.w3.org/2001/xml-events"
      xmlns:xxforms="http://orbeon.org/oxf/xml/xforms"
      xmlns:fr="http://orbeon.org/oxf/xml/form-runner">
      
    <head>
        <title>AtomBeat DataWiki</title>
        
        <xforms:model id="mod-main">
        
            <xforms:instance id="ins-table" src="/apps/datawiki/template-table.xml"/>
            
        </xforms:model>
        
        <style type="text/css">
            .data-table { background-color: #fce5b6 }
            .data-table .add-td {  }
            .data-table .form-td { background: transparent; padding: 0 }
            .data-table thead .xforms-repeat-selected-item-1 { background: transparent }
        
        </style>

    </head>
    
    <body>
    
    	<p>Welcome to DataWiki!</p>
    	
    	<fr:tabview>
    		<fr:tab>
    			<fr:label>View Data</fr:label>
    			
    			<xforms:group ref="instance('ins-table')">
    			
	    			<fr:datatable>
	    			
	    				<thead>
	    					<tr>
	    						<xforms:repeat nodeset="view/variables/variable" id="rep-view-variables">
									<th fr:sortable="true" fr:resizeable="true">
										<xforms:output value="instance('ins-table')/variables/variable[id=xxforms:context('rep-view-variables')]/label"/>
									</th>	    						
	    						</xforms:repeat>
	    					</tr>
	    				</thead>
	    				
	    				<tbody>
	    					<xforms:repeat nodeset="view/tuples/tuple" id="rep-view-tuples">
	    						<tr>
		    						<xforms:repeat nodeset="instance('ins-table')/view/variables/variable" id="rep-row-view-variables">
										<td>
											<xforms:output value="instance('ins-table')/data/datum[tuple=xxforms:context('rep-view-tuples') and variable=xxforms:context('rep-row-view-variables')]/value"/>
										</td>	    						
		    						</xforms:repeat>
	    						</tr>
	    					</xforms:repeat>
	    				</tbody>
	    			</fr:datatable>

    			</xforms:group>
    			
    		</fr:tab>
    		<fr:tab>
    			<fr:label>TODO</fr:label>
    		</fr:tab>
    	</fr:tabview>
    	
    </body>
</html>
